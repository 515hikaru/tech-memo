---
title: "Mr"
date: 2018-10-24T12:42:30+09:00
draft: false
categories: []
---

# 素数判定の重要性

与えられた数 \\(n\\) が素数であるかどうかを判定する問題は, 早く正確に解けることが肝要である. なぜならば, 主流の暗号化方式の RSA において, 与えられた数が素数であるかどうかは暗号強度に関係するからだ.

そこで, 実際にどのようにして素数判定を行っているのかを解説し, 与えられた正の整数 \\(n\\) が素数であるかどうかを判定する関数を Python で実装してみた.

# 素数判定に使う事実

まず, これは数学的な事実である. Wikipedia にも[^1]解説がある.

[^1]: 2018年2月16日現在

\\(n\\) が奇素数であり, \\(n - 1 = 2^sd\\) と表されているとき, 任意の \\(a\in(\mathbb{Z}/n\mathbb{Z})^\times\\)に対して下記の条件のうち少なくとも1つが成り立つ:

1. \\(a^d \equiv 1 \pmod n\\)
2. 任意の \\(0 \le r \le s-1\\) なる整数 \\(r\\) に対して \\(a^{2^rd} \equiv -1 \pmod n\\)

この事実の対偶が素数判定に使う事実である. すなわち, \\(n\\) を奇数とし, \\(n-1\\) を上記と同じ形式で表現したとき, ある \\(a\in(\mathbb{Z}/n\mathbb{Z})^\times\\) が存在し,

1. \\(a^d \not \equiv 1 \pmod n\\)
2. ある \\(0 \le r \le  s - 1\\) なる整数 \\(r\\) が存在し, \\(a^{2^rd} \not \equiv -1 \pmod n\\)

がどちらも成り立つならば, \\(n\\) は合成数である.

##

上記の条件を満たすような整数はかならず合成数であるので, 条件を満たさなければ素数である確率が「高い」と言えよう. しかし, \\(a\in(\mathbb{Z}/n\mathbb{Z})^\times\\) として, たまたま合成数の条件をくぐり抜けてしまい, 素数と誤判定してしまうことはないだろうか[^2].

[^2]: 上記の主張だけでは少なくとも1つは存在することしか言及できていないので, \\(n\\) が素数であることをチェックするためには条件を \\(\varphi(n)\\) 個の元について計算しないといけないことになる.正確性は担保されるが, 計算量が膨大になる可能性がある.
